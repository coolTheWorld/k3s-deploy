# 启用 etcd 集群
etcd:
  enabled: true
  replicaCount: 3
  auth:
    rbac:
      create: true
#      rootPassword: "strong-password"

# replicaCount: 3
# 启用高可用（移除 replicaCount）
autoscaling:
  enabled: true
  minReplicas: 1  
  maxReplicas: 5
  targetCPUUtilizationPercentage: 80
  targetMemoryUtilizationPercentage: 80
resources:
  requests:
    cpu: 250m
    memory: 128Mi
  limits:
    cpu: 1000m
    memory: 512Mi

# 服务配置
service:
  #记录客户端ip
#  externalTrafficPolicy: Local  
  # K3s 会自动分配一个 EXTERNAL-IP
  type: LoadBalancer  
  #type: ClusterIP  
  externalTrafficPolicy: Cluster
  # 添加自定义端口
  http:
    enabled: true
    servicePort: 19080      # LoadBalancer 暴露的端口
    containerPort: 9080     # APISIX 容器内部端口

# 安全配置
apisix:
  admin:
    allow:
      ipList:
        - 10.0.0.0/16 
        - 127.0.0.1/24
     # 注意：需要提前创建此 Secret
#    credentials:
#      secretName: apisix-admin-secret
  # 启用监控
  prometheus:
    enabled: true

# 监控配置
#metrics:
#  serviceMonitor:
#    enabled: true
#    namespace: kube-system

# Ingress controller 配置
ingress-controller:
  enabled: true
  apisix:
    adminService:
      namespace: kube-system 
      name: apisix-admin
      port: 9180
  gatewayProxy:
    createDefault: true
